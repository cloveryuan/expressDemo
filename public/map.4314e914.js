!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=71)}({0:function(e,t){e.exports=window.$},26:function(e,t){e.exports=window.preact},43:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},50:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},51:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}},52:function(e,t,n){var a=n(72);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},53:function(e,t,n){var a=n(73),i=n(74);e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?i(e):t}},71:function(e,t,n){"use strict";n.r(t);var a=n(50),i=n.n(a),s=n(51),o=n.n(s),r=n(52),c=n.n(r),d=n(53),u=n.n(d),l=n(43),p=n.n(l),f=n(0),m=n.n(f),v=n(26);n(75);function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var y={0:"有发烧",1:"无发烧"},b={0:"有咳嗽",1:"无咳嗽"},w={0:"身份证和电子凭证信息一致",1:"身份证和电子凭证信息不一致"};function x(e){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),n=document.cookie.match(t);return n&&n.length>0?unescape(n[2]):null}var S=function(e){c()(a,e);var t,n=(t=a,function(){var e,n=p()(t);if(h()){var a=p()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return u()(this,e)});function a(e){var t;return i()(this,a),(t=n.call(this,e)).state={current:{},data:[],listMember:[],mapLoaded:!1},t}return o()(a,[{key:"componentWillMount",value:function(){var e=this,t=x("access_token"),n=window.qs.parse(location.search.substring(1));m.a.ajax({type:"GET",url:"/api/companionRecord/list",cache:!1,data:{access_token:t,recordId:n.recordId},success:function(t){e.setState({current:t.data})}}),m.a.ajax({type:"GET",url:"/api/companionRecord/listMember",cache:!1,data:{recordId:n.recordId},success:function(t){e.setState({listMember:t.data})}})}},{key:"componentDidMount",value:function(){var e=this,t=window.qs.parse(location.search.substring(1)),n=x("access_token"),a=this;m.a.ajax({type:"GET",url:"/api/locationRecord/scatter",cache:!1,data:{access_token:n,recordId:t.recordId},success:function(t){e.setState({data:t.data})}}),loadSpecConfig((function(e){if(m()(".header-title").text(e.backendSystemName||e.city+"疫情防控登记系统"),e.peopleLocation){var t=e.peopleLocation.split(",").map(Number),n=new AMap.Map("map",{center:t,zoom:11});n.on("click",(function(){n.clearInfoWindow()})),n.on("complete",(function(){a.setState({mapLoaded:!0})})),a.map=n}})),window.mapInstance=this}},{key:"scatter",value:function(e){var t=this,n=x("access_token");m.a.ajax({type:"GET",url:"/api/locationRecord/scatter",cache:!1,data:{access_token:n,recordId:e},success:function(e){t.renderScatter(e.data)}})}},{key:"renderScatter",value:function(e){var t=this;(e||this.state.data).forEach((function(e,n){var a=new AMap.Marker({content:"<div class='default-marker'>"+(n+1)+"</div>",position:[+e.lng,+e.lat]}),i=new AMap.InfoWindow({isCustom:!0,content:"<div class='info-window'><div class='info-window-arrow'></div><div class='info-window-box'>            <div class='infowin-item'><span class='infowin-item-name'>核验人</span><span style=' display:inline-block;width: 130px'>"+(e.reportPersonName||"")+"</span><span class='infowin-item-name'>手机</span><span>"+(e.reportPersonPhone||"")+"</span></div>            <div class='infowin-item'><span class='infowin-item-name'>时间</span><span>"+e.recordTime+"</span></div>            <div class='infowin-item'><span class='infowin-item-name'>类型</span><span>"+(window.REPORT_TYPE[e.reportType]||"")+"</span></div>            <div class='infowin-item'><span class='infowin-item-name'>核验</span><span class='infowin-attr'>"+(y[e.temperature]||"")+"</span><span class='infowin-attr'>"+(b[e.cough]||"")+"</span><span class='infowin-attr'>"+(w[e.identityConsistency]||"")+"</span></div>            <div class='infowin-item'><span class='infowin-item-name'>地点</span><span>"+e.area+"</span></div>            <div class='infowin-item'><span class='infowin-item-name'>备注</span><span>"+(e.commnet||"")+"</span></div>          </div></div>",offset:new AMap.Pixel(0,-30)});a.on("click",(function(){i.open(t.map,a.getPosition())})),t.map.add(a)}))}},{key:"renderHeader",value:function(){var e=(this.state.current.data||[])[0];if(void 0!==e){var t="<div class='header-box'><h2 class='box-item' style='line-height: 50px'>人员轨迹地图</h2><div class='box-item'><div class='container'><div onclick={$('#userList').show()} class='corner'></div></div><div class='box-item person-info'><div class='info-item'><sapn class='infoitem-name'>姓名</sapn><span class='item-value' id='name'>"+e.name+"</span></div><div class='info-item'><sapn class='infoitem-name'>手机</sapn><span class='item-value' id='phone'>"+e.phone+"</span></div><div class='info-item'><sapn class='infoitem-name'>证件号码</sapn><span class='item-value' id='idCardNum'>"+e.idCardNum+"</span></div><div class='info-item'><sapn class='infoitem-name'>状况</sapn><span class='item-value' id='healthStatus'>"+this.health(e.healthStatus)+"</span></div><div class='info-item'><sapn class='infoitem-name'>居住地</sapn><span class='item-value' id='address'>"+e.destProv+e.destCity+e.destDistrict+e.destStreet+e.destArea+e.destAddr+"<span></div></div></div></div><ul id='userList' class='header-user-list'>"+this.users()+"</ul>";m()("#app").append(t)}}},{key:"users",value:function(){var e=this,t=this.state.listMember,n="";return t.forEach((function(t){n+='<li onclick="selectUser('+JSON.stringify(t).replace(/"/g,"&quot;")+")\" class=\"box-item person-info box-user\"><div class='info-item' id='name'>姓名："+t.name+"</div><div class='info-item' id='phone'>手机："+t.phone+"</div><div class='info-item' id='idCardNum'>证件号码："+t.idCardNum+"</div><div class='info-item' id='healthStatus'>状况："+e.health(t.healthStatus)+"</div><div class='info-item' id='address'>居住地："+t.destProv+t.destCity+t.destDistrict+t.destStreet+t.destArea+t.destAddr+"</div></li>"})),n}},{key:"health",value:function(e){switch(e){case 0:return"<span>正常</span>";case 1:return"<span class='red'>异常</span>";default:return"<span>-</span>"}}},{key:"render",value:function(e,t){return t.mapLoaded&&(this.renderScatter(),this.renderHeader()),Object(v.h)("div",null,Object(v.h)("div",{id:"map"}))}}]),a}(v.Component);Object(v.render)(Object(v.h)(S),document.getElementById("app")),window.selectUser=function(e){m()("#userList").hide(),m()("#name").html(e.name),m()("#phone").html(e.phone),m()("#idCardNum").html(e.idCardNum),m()("#healthStatus").html(0===e.healthStatus?"正常":"<span class='red'>异常</span>"),m()("#address").html(e.destProv+e.destCity+e.destDistrict+e.destStreet+e.destArea+e.destAddr),mapInstance.scatter(e.recordId)}},72:function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},73:function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},74:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},75:function(e,t,n){}});